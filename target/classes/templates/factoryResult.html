<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
 <head>
         <meta charset="UTF-8">
         <title>一厂报表</title>
     <meta charset="UTF-8"/>
     <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/>
     <link href='https://cdn.jsdelivr.net/npm/bootstrap@3.3.7/dist/css/bootstrap.min.css' rel='stylesheet'>
 </head>
 <body>
 <div id="msg"></div>
 <form th:action="@{/first}" method="post" enctype="multipart/form-data">
     <input type="file" name="file"/>
     <input type="text" name="year"/>
     <input type="text" name="month"/>
     <input type="submit" value="一厂上传">
 </form>
 <form th:action="@{/sec}" method="post" enctype="multipart/form-data">
     <input type="file" name="file"/>
     <input type="text" name="year"/>
     <input type="text" name="month"/>
     <input type="submit" value="月台上传">
 </form>
 <input type="text" id="year1" >
 <input type="text" id="month1" >
 <button  type="button" id="testBtn">计算求和</button>
 <button  type="button" id="testBtn1">导出结果集</button>
     <div id="userDiv" >

         <table id="table1" class="table table-bordered">
             <tr>
                 <td>会计期间</td>
                 <td>项目号</td>
                 <td>项目名称</td>
                 <td>物料编码</td>
                 <td>物料名称</td>
                 <td>数量</td>
                 <td>设备</td>
                 <td>工时</td>
                 <td>直接人工正式工资</td>
                 <td>直接人工劳务工资</td>
                 <td>间接人工正式工资</td>
                 <td>间接人工劳务工资</td>
                 <td>水电</td>
                 <td>刀具</td>
                 <td>消耗</td>
                 <td>修理</td>
                 <td>餐费</td>
                 <td>保险</td>
                 <td>办公</td>
                 <td>差施</td>
                 <td>劳保</td>
                 <td>其他折旧</td>
                 <td>设备折旧</td>

             </tr>
             <tr th:each="r : ${result}" >
                 <td th:text="${r.fiscalPeriod}"></td>
                 <td th:text="${r.projectNumber}"></td>
                 <td th:text="${r.projectName}"></td>
                 <td th:text="${r.materialCode}"></td>
                 <td th:text="${r.materialName}"></td>
                 <td th:text="${r.count}"></td>
                 <td th:text="${r.device}"></td>
                 <td th:text="${r.manHour}"></td>
                 <td th:text="${r.directRegularSalary}"></td>
                 <td th:text="${r.directLaborSalary}"></td>
                 <td th:text="${r.indirectRegularSalary}"></td>
                 <td th:text="${r.indirectLaborSalary}"></td>
                 <td th:text="${r.waterElectricity}"></td>
                 <td th:text="${r.tool}"></td>
                 <td th:text="${r.consume}"></td>
                 <td th:text="${r.repair}"></td>
                 <td th:text="${r.mealFee}"></td>
                 <td th:text="${r.insurance}"></td>
                 <td th:text="${r.office}"></td>
                 <td th:text="${r.travel}"></td>
                 <td th:text="${r.labour}"></td>
                 <td th:text="${r.otherDepreciation}"></td>
                 <td th:text="${r.deviceDepreciation}"></td>

             </tr>
         </table>
     </div>
     <script src='https://cdn.jsdelivr.net/npm/jquery@1.12.4/dist/jquery.min.js'></script>
     <script src='https://cdn.jsdelivr.net/npm/bootstrap@3.3.7/dist/js/bootstrap.min.js'></script>


     <script type="text/javascript" th:inline="javascript">
         /*<![CDATA[*/

             $('#testBtn').click(function () {
                 var v1 = $('#year1').val();
                 var v2 = $('#month1').val();
                 $.get({
                     url:'/sum',
                     data:{year:v1,month:v2},
                     success: function (result) {
                         //$("#userDiv").html(result);
                     }
                 });
             });
         $('#testBtn1').click(function () {
             var v1 = $('#year1').val();
             var v2 = $('#month1').val();
             $.get({
                 url:'/excel',
                 data:{year:v1,month:v2},
                 success: function (result) {
                     //$("#userDiv").html(result);
                 }
             });
         });

         /*]]>*/
     </script>
 </body>
</html>
